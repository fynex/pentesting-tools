#!/usr/bin/env python
# -*- coding: utf-8 -*-

import argparse
import subprocess
import socket

def read(file_name):
    with open(file_name, "r") as f:
        return f.read()

    return None


def read_list(file_name, delim="\n"):
    fc = read(file_name)

    return [e for e in fc.split(delim) if e]


def get_hostname(ip):
    try:
        tup      = socket.gethostbyaddr(ip)
        hostname = tup[0]

        return hostname
    except socket.error:
        return None



parser = argparse.ArgumentParser(description='Mass DNS Lookups')
parser.add_argument("-l", '--list', help='A list with IPs or hostnames')
parser.add_argument("-t", '--table', action="store_true", help='Generates a markdown table with IP and DNS name')

args = parser.parse_args()

host_list = read_list(args.list)

if args.table:
    print("| IP  | DNS  |")
    print("|---|---|")

for e in host_list:
    hostname = get_hostname(e)

    if hostname:
        if args.table:
            print("| {} | {} |".format(e, hostname))
        else:
            print(hostname)

